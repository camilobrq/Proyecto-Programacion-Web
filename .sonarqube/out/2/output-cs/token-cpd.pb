ª
VD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\AdministradorService.cs
	namespace		 	
Logica		
 
{

 
public 

class  
AdministradorService %
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public  
AdministradorService #
(# $
ConsultorioContext$ 6
context7 >
)> ?
{ 	
_context 
= 
context 
; 
} 	
public (
GuardarAdministradorResponse +
Guardar, 3
(3 4
Administrador4 A
administradorB O
)O P
{ 	
try 
{ 
var -
!administradorBuscadoNombreUsuario 5
=6 7
_context8 @
.@ A
administradoresA P
.P Q
FindQ U
(U V
administradorV c
.c d
nombreUsuariod q
)q r
;r s
if 
( -
!administradorBuscadoNombreUsuario 5
!=6 8
null9 =
)= >
{ 
return 
new (
GuardarAdministradorResponse ;
(; <
$str	< É
)
É Ñ
;
Ñ Ö
} 
_context 
. 
administradores (
.( )
Add) ,
(, -
administrador- :
): ;
;; <
_context   
.   
SaveChanges   $
(  $ %
)  % &
;  & '
return!! 
new!! (
GuardarAdministradorResponse!! 7
(!!7 8
administrador!!8 E
)!!E F
;!!F G
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 
return%% 
new%% (
GuardarAdministradorResponse%% 7
(%%7 8
$"%%8 :
$str%%: R
{%%R S
e%%S T
.%%T U
Message%%U \
}%%\ ]
"%%] ^
)%%^ _
;%%_ `
}&& 
}'' 	
public)) 
List)) 
<)) 
Administrador)) !
>))! ",
 ConsultarTodosLosAdministradores))# C
())C D
)))D E
{** 	
List++ 
<++ 
Administrador++ 
>++ 
administradores++  /
=++0 1
_context++2 :
.++: ;
administradores++; J
.++J K
ToList++K Q
(++Q R
)++R S
;++S T
return,, 
administradores,, "
;,," #
}-- 	
}.. 
public11 

class11 (
GuardarAdministradorResponse11 -
{22 
public33 (
GuardarAdministradorResponse33 +
(33+ ,
Administrador33, 9
administrador33: G
)33G H
{44 	
Error55 
=55 
false55 
;55 
this66 
.66 
administrador66 
=66  
administrador66! .
;66. /
}77 	
public88 (
GuardarAdministradorResponse88 +
(88+ ,
string88, 2
mensaje883 :
)88: ;
{99 	
Error:: 
=:: 
true:: 
;:: 
Mensaje;; 
=;; 
mensaje;; 
;;; 
}<< 	
public== 
bool== 
Error== 
{== 
get== 
;==  
set==! $
;==$ %
}==& '
public>> 
string>> 
Mensaje>> 
{>> 
get>>  #
;>># $
set>>% (
;>>( )
}>>* +
public?? 
Administrador?? 
administrador?? *
{??+ ,
get??- 0
;??0 1
set??2 5
;??5 6
}??7 8
}AA 
}BB ˜ö
OD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\AgendaService.cs
	namespace 	
Logica
 
{		 
public

 

class

 
AgendaService

 
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
AgendaService 
( 
ConsultorioContext /
context0 7
)7 8
{ 	
_context 
= 
context 
; 
} 	
public !
AgendaGuardarResponse $
Guardar% ,
(, -
Agenda- 3
agenda4 :
): ;
{ 	
try 
{ 
var 
	Psicologo 
= 
_context  (
.( )

psicologos) 3
.3 4
Find4 8
(8 9
agenda9 ?
.? @
	psicologo@ I
.I J
identificacionJ X
)X Y
;Y Z
if 
( 
	Psicologo 
==  
null! %
)& '
{ 
return 
new !
AgendaGuardarResponse 4
(4 5
$"5 7
$str7 l
"l m
)m n
;n o
} 
agenda!! 
.!! 
	psicologo!!  
=!!! "
	Psicologo!!# ,
;!!, -
_context"" 
."" 
agendas""  
.""  !
Add""! $
(""$ %
agenda""% +
)""+ ,
;"", -
_context## 
.## 
SaveChanges## $
(##$ %
)##% &
;##& '
return(( 
new(( !
AgendaGuardarResponse(( 0
(((0 1
agenda((1 7
)((7 8
;((8 9
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 
return,, 
new,, !
AgendaGuardarResponse,, 0
(,,0 1
$",,1 3
$str,,3 P
{,,P Q
e,,R S
.,,S T
Message,,T [
},,[ \
",,\ ]
),,] ^
;,,^ _
}-- 
}// 	
public11 
string11 
Eliminar11 
(11 
string11 %
idAgenda11& .
)11. /
{22 	
try33 
{44 
var55 
agenda55 
=55 
_context55 %
.55% &
agendas55& -
.55- .
Find55. 2
(552 3
idAgenda553 ;
)55; <
;55< =
if66 
(66 
agenda66 
!=66 
null66 "
)66" #
{77 
_context88 
.88 
Remove88 #
(88# $
agenda88$ *
)88* +
;88+ ,
_context99 
.99 
SaveChanges99 (
(99( )
)99) *
;99* +
return:: 
$":: 
$str:: ?
{::? @
idAgenda::@ H
}::H I
"::I J
;::J K
};; 
return<< 
$"<< 
$str<< b
{<<b c
idAgenda<<c k
}<<k l
"<<l m
;<<m n
}== 
catch>> 
(>> 
	Exception>> 
e>> 
)>> 
{?? 
return@@ 
$"@@ 
$str@@ 7
{@@7 8
e@@8 9
.@@9 :
Message@@: A
}@@A B
"@@B C
;@@C D
}AA 
}CC 	
publicEE "
AgendaConsultaResponseEE %
	ConsultarEE& /
(EE/ 0
)EE0 1
{FF 	
tryGG 
{HH 
returnJJ 
newJJ "
AgendaConsultaResponseJJ 1
(JJ1 2
_contextJJ2 :
.JJ: ;
agendasJJ; B
.JJB C
ToListJJC I
(JJI J
)JJJ K
)JJK L
;JJL M
}LL 
catchMM 
(MM 
	ExceptionMM 
eMM 
)MM 
{NN 
returnOO 
newOO "
AgendaConsultaResponseOO 1
(OO1 2
$"OO2 4
$strOO4 S
{OOS T
eOOT U
.OOU V
MessageOOV ]
}OO] ^
"OO^ _
)OO_ `
;OO` a
}PP 
}RR 	
publicSS  
AgendaBuscarResponseSS #
BuscarSS$ *
(SS* +
stringSS+ 1
idAgendaSS2 :
)SS: ;
{TT 	
tryUU 
{VV 
varXX 
agendaXX 
=XX 
_contextXX %
.XX% &
agendasXX& -
.XX- .
FindXX. 2
(XX2 3
idAgendaXX3 ;
)XX; <
;XX< =
ifYY 
(YY 
agendaYY 
==YY 
nullYY "
)YY" #
{ZZ 
throw\\ 
new\\ '
AgendaNoEncontradaException\\ 9
(\\9 :
$str\\: y
)\\y z
;\\z {
}]] 
return^^ 
new^^  
AgendaBuscarResponse^^ /
(^^/ 0
agenda^^0 6
)^^6 7
;^^7 8
}__ 
catch`` 
(`` '
AgendaNoEncontradaException`` .
e``/ 0
)``0 1
{aa 
returnbb 
newbb  
AgendaBuscarResponsebb /
(bb/ 0
$strbb0 B
+bbC D
ebbE F
.bbF G
MessagebbG N
)bbN O
;bbO P
}cc 
catchdd 
(dd 
	Exceptiondd 
edd 
)dd 
{ee 
returnff 
newff  
AgendaBuscarResponseff /
(ff/ 0
$strff0 M
+ffN O
effP Q
.ffQ R
MessageffR Y
)ffY Z
;ffZ [
}gg 
}ii 	
publicjj 
Listjj 
<jj 
stringjj 
>jj 

nuevaListajj &
(jj& '
)jj' (
{kk 	
Listll 
<ll 
Agendall 
>ll 
agendall 
=ll  !
_contextll" *
.ll* +
agendasll+ 2
.ll2 3
ToListll3 9
(ll9 :
)ll: ;
;ll; <
Listmm 
<mm 
stringmm 
>mm 
listaHoraAgendamm (
=mm) *
newmm+ .
Listmm/ 3
<mm3 4
stringmm4 :
>mm: ;
(mm; <
)mm< =
;mm= >
foreachoo 
(oo 
varoo 
itemoo 
inoo  
agendaoo! '
)oo' (
{pp 
varrr 

almacenadorr 
=rr  
itemrr! %
.rr% &
fechaDeseadarr& 2
+rr3 4
itemrr5 9
.rr9 :
horaCitarr: B
;rrB C
listaHoraAgendass 
.ss  
Addss  #
(ss# $

almacenadoss$ .
)ss. /
;ss/ 0
}tt 
returnuu 
listaHoraAgendauu "
;uu" #
}vv 	
publicxx 

AgendaListxx !
buscarFechaDisponiblexx /
(xx/ 0
DateTimexx0 8
fechaxx9 >
)xx> ?
{yy 	
try|| 
{}} 
List~~ 
<~~ 
Agenda~~ 
>~~ 
agenda~~ #
=~~$ %
_context~~& .
.~~. /
agendas~~/ 6
.~~6 7
ToList~~7 =
(~~= >
)~~> ?
;~~? @
List 
< 
string 
> 
horaCita %
=& '
new( +
List, 0
<0 1
string1 7
>7 8
(8 9
)9 :
;: ;
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ 
item
ÄÄ !
in
ÄÄ" $
agenda
ÄÄ% +
)
ÄÄ+ ,
{
ÅÅ 
if
ÇÇ 
(
ÇÇ 
item
ÇÇ 
.
ÇÇ 
fechaDeseada
ÇÇ )
==
ÇÇ* ,
fecha
ÇÇ- 2
)
ÇÇ2 3
{
ÉÉ 
var
ÑÑ 

almacenado
ÑÑ &
=
ÑÑ' (
item
ÑÑ) -
.
ÑÑ- .
horaCita
ÑÑ. 6
;
ÑÑ6 7
horaCita
ÖÖ  
.
ÖÖ  !
Add
ÖÖ! $
(
ÖÖ$ %

almacenado
ÖÖ% /
)
ÖÖ/ 0
;
ÖÖ0 1
}
ÜÜ 
}
àà 
return
ââ 
new
ââ 

AgendaList
ââ %
(
ââ% &
horaCita
ââ& .
)
ââ. /
;
ââ/ 0
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
e
åå 
)
åå 
{
çç 
return
éé 
new
éé 

AgendaList
éé %
(
éé% &
$"
éé& (
$str
éé( G
{
ééG H
e
ééH I
.
ééI J
Message
ééJ Q
}
ééQ R
"
ééR S
)
ééS T
;
ééT U
}
èè 
}
êê 	
public
íí 
List
íí 
<
íí 
string
íí 
>
íí 
buscarPsicologo
íí +
(
íí+ ,
string
íí, 2
hora
íí3 7
)
íí7 8
{
ìì 	
List
îî 
<
îî 
Agenda
îî 
>
îî 
agenda
îî 
=
îî  !
_context
îî" *
.
îî* +
agendas
îî+ 2
.
îî2 3
ToList
îî3 9
(
îî9 :
)
îî: ;
;
îî; <
List
ïï 
<
ïï 
	Psicologo
ïï 
>
ïï 
	psicologo
ïï %
=
ïï& '
_context
ïï( 0
.
ïï0 1

psicologos
ïï1 ;
.
ïï; <
ToList
ïï< B
(
ïïB C
)
ïïC D
;
ïïD E
List
ññ 
<
ññ 
string
ññ 
>
ññ 
nombrePsicologo
ññ (
=
ññ) *
new
ññ+ .
List
ññ/ 3
<
ññ3 4
string
ññ4 :
>
ññ: ;
(
ññ; <
)
ññ< =
;
ññ= >
foreach
óó 
(
óó 
var
óó 
item
óó 
in
óó  
agenda
óó! '
)
óó' (
{
òò 
if
ôô 
(
ôô 
item
ôô 
.
ôô 
horaCita
ôô !
==
ôô" $
hora
ôô% )
)
ôô) *
{
öö 
foreach
õõ 
(
õõ 
var
õõ  
e
õõ! "
in
õõ# %
	psicologo
õõ& /
)
õõ/ 0
{
úú 
if
ùù 
(
ùù 
item
ùù  
.
ùù  !
idPsicologo
ùù! ,
==
ùù- /
e
ùù0 1
.
ùù1 2
identificacion
ùù2 @
)
ùù@ A
{
ûû 
var
üü 

almacenado
üü  *
=
üü+ ,
e
üü- .
.
üü. /
nombre
üü/ 5
+
üü6 7
$str
üü8 ;
+
üü< =
e
üü> ?
.
üü? @
apellido
üü@ H
;
üüH I
nombrePsicologo
†† +
.
††+ ,
Add
††, /
(
††/ 0

almacenado
††0 :
)
††: ;
;
††; <
}
°° 
}
¢¢ 
}
££ 
}
§§ 
return
•• 
nombrePsicologo
•• "
;
••" #
}
ßß 	
public
ΩΩ 
List
ΩΩ 
<
ΩΩ 
string
ΩΩ 
>
ΩΩ 
buscarTerapia
ΩΩ )
(
ΩΩ) *
string
ΩΩ* 0
nombrePsicologo
ΩΩ1 @
)
ΩΩ@ A
{
ææ 	
List
øø 
<
øø 
Agenda
øø 
>
øø 
agenda
øø 
=
øø  !
_context
øø" *
.
øø* +
agendas
øø+ 2
.
øø2 3
ToList
øø3 9
(
øø9 :
)
øø: ;
;
øø; <
List
¿¿ 
<
¿¿ 
	Psicologo
¿¿ 
>
¿¿ 
	psicologo
¿¿ %
=
¿¿& '
_context
¿¿( 0
.
¿¿0 1

psicologos
¿¿1 ;
.
¿¿; <
ToList
¿¿< B
(
¿¿B C
)
¿¿C D
;
¿¿D E
List
¡¡ 
<
¡¡ 
string
¡¡ 
>
¡¡ 
TerapiaPsicologo
¡¡ )
=
¡¡* +
new
¡¡, /
List
¡¡0 4
<
¡¡4 5
string
¡¡5 ;
>
¡¡; <
(
¡¡< =
)
¡¡= >
;
¡¡> ?
foreach
¬¬ 
(
¬¬ 
var
¬¬ 
item
¬¬ 
in
¬¬  
	psicologo
¬¬! *
)
¬¬* +
{
√√ 
var
ƒƒ 
nombreCompleto
ƒƒ "
=
ƒƒ# $
item
ƒƒ% )
.
ƒƒ) *
nombre
ƒƒ* 0
+
ƒƒ1 2
$str
ƒƒ3 6
+
ƒƒ7 8
item
ƒƒ9 =
.
ƒƒ= >
apellido
ƒƒ> F
;
ƒƒF G
if
≈≈ 
(
≈≈ 
nombreCompleto
≈≈ "
==
≈≈# %
nombrePsicologo
≈≈& 5
)
≈≈5 6
{
∆∆ 
var
«« 
almacenarTerapia
«« (
=
««) *
item
««+ /
.
««/ 0
areaEspecializada
««0 A
;
««A B
TerapiaPsicologo
»» $
.
»»$ %
Add
»»% (
(
»»( )
almacenarTerapia
»») 9
)
»»9 :
;
»»: ;
}
…… 
}
   
return
ÀÀ 
TerapiaPsicologo
ÀÀ #
;
ÀÀ# $
}
ÃÃ 	
}
ÕÕ 
public
ŒŒ 
class
ŒŒ #
AgendaGuardarResponse
ŒŒ '
{
œœ 
public
–– 
Agenda
–– 
Agenda
–– 
{
–– 
get
–– "
;
––" #
set
––$ '
;
––' (
}
––) *
public
—— 
string
—— 
Mensaje
—— 
{
—— 
get
——  #
;
——# $
set
——% (
;
——( )
}
——* +
public
““ 
bool
““ 
IsError
““ 
{
““ 
get
““ !
;
““! "
set
““# &
;
““& '
}
““( )
public
‘‘ #
AgendaGuardarResponse
‘‘ $
(
‘‘$ %
Agenda
‘‘% +
agenda
‘‘, 2
)
‘‘2 3
{
’’ 	
Agenda
÷÷ 
=
÷÷ 
agenda
÷÷ 
;
÷÷ 
IsError
ÿÿ 
=
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
public
⁄⁄ #
AgendaGuardarResponse
⁄⁄ $
(
⁄⁄$ %
string
⁄⁄% +
mensaje
⁄⁄, 3
)
⁄⁄3 4
{
€€ 	
Mensaje
‹‹ 
=
‹‹ 
mensaje
‹‹ 
;
‹‹ 
IsError
›› 
=
›› 
true
›› 
;
›› 
}
ﬁﬁ 	
}
ﬂﬂ 
public
‡‡ 
class
‡‡ "
AgendaBuscarResponse
‡‡ &
{
·· 
public
‚‚ 
Agenda
‚‚ 
Agenda
‚‚ 
{
‚‚ 
get
‚‚ "
;
‚‚" #
set
‚‚$ '
;
‚‚' (
}
‚‚) *
public
„„ 
string
„„ 
Mensaje
„„ 
{
„„ 
get
„„  #
;
„„# $
set
„„% (
;
„„( )
}
„„* +
public
‰‰ 
bool
‰‰ 
IsError
‰‰ 
{
‰‰ 
get
‰‰ !
;
‰‰! "
set
‰‰# &
;
‰‰& '
}
‰‰( )
public
ÊÊ "
AgendaBuscarResponse
ÊÊ #
(
ÊÊ# $
Agenda
ÊÊ$ *
agenda
ÊÊ+ 1
)
ÊÊ1 2
{
ÁÁ 	
Agenda
ËË 
=
ËË 
agenda
ËË 
;
ËË 
IsError
ÈÈ 
=
ÈÈ 
false
ÈÈ 
;
ÈÈ 
}
ÍÍ 	
public
ÎÎ "
AgendaBuscarResponse
ÎÎ #
(
ÎÎ# $
string
ÎÎ$ *
mensaje
ÎÎ+ 2
)
ÎÎ2 3
{
ÏÏ 	
Mensaje
ÌÌ 
=
ÌÌ 
mensaje
ÌÌ 
;
ÌÌ 
IsError
ÓÓ 
=
ÓÓ 
true
ÓÓ 
;
ÓÓ 
}
ÔÔ 	
}
 
public
ÒÒ 

class
ÒÒ $
AgendaConsultaResponse
ÒÒ '
{
ÚÚ 
public
ÛÛ 
List
ÛÛ 
<
ÛÛ 
Agenda
ÛÛ 
>
ÛÛ 
Agendas
ÛÛ #
{
ÛÛ$ %
get
ÛÛ& )
;
ÛÛ) *
set
ÛÛ+ .
;
ÛÛ. /
}
ÛÛ0 1
public
ÙÙ 
List
ÙÙ 
<
ÙÙ 
string
ÙÙ 
>
ÙÙ 
listaAgendas
ÙÙ (
{
ÙÙ) *
get
ÙÙ+ .
;
ÙÙ. /
set
ÙÙ0 3
;
ÙÙ3 4
}
ÙÙ5 6
public
ıı 
string
ıı 
Mensaje
ıı 
{
ıı 
get
ıı  #
;
ıı# $
set
ıı% (
;
ıı( )
}
ıı* +
public
ˆˆ 
bool
ˆˆ 
Error
ˆˆ 
{
ˆˆ 
get
ˆˆ 
;
ˆˆ  
set
ˆˆ! $
;
ˆˆ$ %
}
ˆˆ& '
public
˜˜ $
AgendaConsultaResponse
˜˜ %
(
˜˜% &
List
˜˜& *
<
˜˜* +
Agenda
˜˜+ 1
>
˜˜1 2
agendas
˜˜3 :
)
˜˜: ;
{
¯¯ 	
Agendas
˘˘ 
=
˘˘ 
agendas
˘˘ 
;
˘˘ 
Error
˙˙ 
=
˙˙ 
false
˙˙ 
;
˙˙ 
}
˚˚ 	
public
¸¸ $
AgendaConsultaResponse
¸¸ %
(
¸¸% &
List
¸¸& *
<
¸¸* +
string
¸¸+ 1
>
¸¸1 2
agendasList
¸¸3 >
)
¸¸> ?
{
˝˝ 	
listaAgendas
˛˛ 
=
˛˛ 
agendasList
˛˛ &
;
˛˛& '
Error
ˇˇ 
=
ˇˇ 
false
ˇˇ 
;
ˇˇ 
}
ÄÄ 	
public
ÅÅ $
AgendaConsultaResponse
ÅÅ %
(
ÅÅ% &
string
ÅÅ& ,
mensaje
ÅÅ- 4
)
ÅÅ4 5
{
ÇÇ 	
Mensaje
ÉÉ 
=
ÉÉ 
mensaje
ÉÉ 
;
ÉÉ 
Error
ÑÑ 
=
ÑÑ 
true
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
}
ÜÜ 
public
áá 

class
áá 

AgendaList
áá 
{
àà 
public
ââ 
List
ââ 
<
ââ 
string
ââ 
>
ââ 
listaAgendas
ââ (
{
ââ) *
get
ââ+ .
;
ââ. /
set
ââ0 3
;
ââ3 4
}
ââ5 6
public
ää 
string
ää 
Mensaje
ää 
{
ää 
get
ää  #
;
ää# $
set
ää% (
;
ää( )
}
ää* +
public
ãã 
bool
ãã 
Error
ãã 
{
ãã 
get
ãã 
;
ãã  
set
ãã! $
;
ãã$ %
}
ãã& '
public
åå 

AgendaList
åå 
(
åå 
List
åå 
<
åå 
string
åå %
>
åå% &
agendasList
åå' 2
)
åå2 3
{
çç 	
listaAgendas
éé 
=
éé 
agendasList
éé &
;
éé& '
Error
èè 
=
èè 
false
èè 
;
èè 
}
êê 	
public
ëë 

AgendaList
ëë 
(
ëë 
string
ëë  
mensaje
ëë! (
)
ëë( )
{
íí 	
Mensaje
ìì 
=
ìì 
mensaje
ìì 
;
ìì 
Error
îî 
=
îî 
true
îî 
;
îî 
}
ïï 	
}
ññ 
public
óó 
class
óó )
AgendaNoEncontradaException
óó -
:
óó. /
	Exception
óó0 9
{
òò 
public
ôô )
AgendaNoEncontradaException
ôô *
(
ôô* +
)
ôô+ ,
{
öö 	
}
õõ 	
public
ùù )
AgendaNoEncontradaException
ùù *
(
ùù* +
string
ùù+ 1
message
ùù2 9
)
ùù9 :
:
ùù; <
base
ùù= A
(
ùùA B
message
ùùB I
)
ùùI J
{
ûû 	
}
†† 	
}
°° 
}¢¢ ¥[
MD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\CitaService.cs
	namespace 	
Logica
 
{ 
public		 

class		 
CitaService		 
{

 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
CitaService 
( 
ConsultorioContext -
context. 5
)5 6
{ 	
_context 
= 
context 
; 
} 	
public 
CitaGuardarResponse "
Guardar# *
(* +
Cita+ /
cita0 4
)4 5
{ 	
try 
{ 
var 
Paciente 
= 
_context %
.% &
	pacientes& /
./ 0
Find0 4
(4 5
cita5 9
.9 :
paciente: B
.B C
identificacionC Q
)Q R
;R S
var 
	respuesta 
= 
buscar %
(% &
cita& *
.* +
fechaDeseada+ 7
,7 8
cita8 <
.< =
horaCita= E
)E F
;F G
if 
( 
Paciente 
== 
null #
&&$ &
	respuesta' 0
==0 2
true2 6
)6 7
{ 
return 
new 
CitaGuardarResponse 2
(2 3
$"3 5
$str5 h
"h i
)i j
;j k
} 
cita 
. 
paciente 
= 
Paciente &
;& '
_context   
.   
citas   
.   
Add   "
(  " #
cita  # '
)  ' (
;  ( )
_context!! 
.!! 
SaveChanges!! $
(!!$ %
)!!% &
;!!& '
return"" 
new"" 
CitaGuardarResponse"" .
("". /
cita""/ 3
)""3 4
;""4 5
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 
return&& 
new&& 
CitaGuardarResponse&& .
(&&. /
$"&&/ 1
$str&&1 N
{&&N O
e&&P Q
.&&Q R
Message&&R Y
}&&Y Z
"&&Z [
)&&[ \
;&&\ ]
}'' 
})) 	
public** 
bool** 
buscar** 
(** 
DateTime** #
fecha**$ )
,**) *
string**+ 1
hora**2 6
)**6 7
{**7 8
List++ 
<++ 
Cita++ 
>++ 
citas++ 
=++ 
_context++ %
.++% &
citas++& +
.+++ ,
ToList++, 2
(++2 3
)++3 4
;++4 5
bool,, 
bandera,, 
=,, 
false,, 
;,, 
foreach-- 
(-- 
var-- 
item-- 
in-- 
citas--  %
)--% &
{--& '
if.. 
(.. 
item.. 
... 
fechaDeseada.. $
...$ %
Equals..% +
(..+ ,
fecha.., 1
)..1 2
&&..3 5
item..6 :
...: ;
horaCita..; C
...C D
Trim..D H
(..H I
)..I J
...J K
Equals..K Q
(..Q R
hora..R V
)..V W
)..X Y
{..Y Z
bandera// 
=// 
true//  
;//  !
}11 
}22 
return33 
bandera33 
;33 
}44 	
public55 
string55 
Eliminar55 
(55 
string55 %
idCita55& ,
)55, -
{66 	
try77 
{88 
var99 
cita99 
=99 
_context99 #
.99# $
citas99$ )
.99) *
Find99* .
(99. /
idCita99/ 5
)995 6
;996 7
if:: 
(:: 
cita:: 
!=:: 
null::  
)::  !
{;; 
_context<< 
.<< 
Remove<< #
(<<# $
cita<<$ (
)<<( )
;<<) *
_context== 
.== 
SaveChanges== (
(==( )
)==) *
;==* +
return>> 
$">> 
$str>> ?
{>>? @
idCita>>@ F
}>>F G
">>G H
;>>H I
}?? 
return@@ 
$"@@ 
$str@@ b
{@@b c
idCita@@c i
}@@i j
"@@j k
;@@k l
}AA 
catchBB 
(BB 
	ExceptionBB 
eBB 
)BB 
{CC 
returnDD 
$"DD 
$strDD 7
{DD7 8
eDD8 9
.DD9 :
MessageDD: A
}DDA B
"DDB C
;DDC D
}EE 
}GG 	
publicHH  
CitaConsultaResponseHH #
	ConsultarHH$ -
(HH- .
)HH. /
{II 	
tryJJ 
{KK 
returnMM 
newMM  
CitaConsultaResponseMM /
(MM/ 0
_contextMM0 8
.MM8 9
citasMM9 >
.MM> ?
ToListMM? E
(MME F
)MMF G
)MMG H
;MMH I
}OO 
catchPP 
(PP 
	ExceptionPP 
ePP 
)PP 
{QQ 
returnRR 
newRR  
CitaConsultaResponseRR /
(RR/ 0
$"RR0 2
$strRR2 Q
{RRQ R
eRRR S
.RRS T
MessageRRT [
}RR[ \
"RR\ ]
)RR] ^
;RR^ _
}SS 
}UU 	
publicVV 
CitaBuscarResponseVV !
BuscarVV" (
(VV( )
stringVV) /
idCitaVV0 6
)VV6 7
{WW 	
tryXX 
{YY 
var[[ 
cita[[ 
=[[ 
_context[[ #
.[[# $
citas[[$ )
.[[) *
Find[[* .
([[. /
idCita[[/ 5
)[[5 6
;[[6 7
if\\ 
(\\ 
cita\\ 
==\\ 
null\\  
)\\  !
{]] 
throw__ 
new__ %
CitaNoEncontradaException__ 7
(__7 8
$str__8 w
)__w x
;__x y
}`` 
returnaa 
newaa 
CitaBuscarResponseaa -
(aa- .
citaaa. 2
)aa2 3
;aa3 4
}bb 
catchcc 
(cc %
CitaNoEncontradaExceptioncc ,
ecc- .
)cc. /
{dd 
returnee 
newee 
CitaBuscarResponseee -
(ee- .
$stree. @
+eeA B
eeeC D
.eeD E
MessageeeE L
)eeL M
;eeM N
}ff 
catchgg 
(gg 
	Exceptiongg 
egg 
)gg 
{hh 
returnii 
newii 
CitaBuscarResponseii -
(ii- .
$strii. K
+iiL M
eiiN O
.iiO P
MessageiiP W
)iiW X
;iiX Y
}jj 
}ll 	
publicmm 
stringmm 
nombrePacientemm $
(mm$ %
stringmm% +
idmm, .
)mm. /
{mm/ 0
Listoo 
<oo 
Citaoo 
>oo 
citasoo 
=oo 
_contextoo %
.oo% &
citasoo& +
.oo+ ,
ToListoo, 2
(oo2 3
)oo3 4
;oo4 5
Listpp 
<pp 
Pacientepp 
>pp 
	pacientespp $
=pp$ %
_contextpp% -
.pp- .
	pacientespp. 7
.pp7 8
ToListpp8 >
(pp> ?
)pp? @
;pp@ A
stringqq 
nombreqq 
=qq 
$strqq 
;qq 
foreachrr 
(rr 
varrr 
itemrr 
inrr 
citasrr  %
)rr% &
{rr& '
ifss 
(ss 
itemss 
.ss 

idPacientess "
==ss" $
idss$ &
)ss& '
{ss' (
foreachtt 
(tt 
vartt  
ett! "
intt# %
	pacientestt& /
)tt/ 0
{tt0 1
ifuu 
(uu 
itemuu 
.uu  

idPacienteuu  *
==uu* ,
euu, -
.uu- .
identificacionuu. <
)uu< =
{uu= >
nombrevv "
=vv" #
evv# $
.vv$ %
nombrevv% +
+vv+ ,
$strvv, /
+vv/ 0
evv0 1
.vv1 2
apellidovv2 :
;vv: ;
}ww 
}xx 
}yy 
}{{ 
return|| 
nombre|| 
;|| 
}}} 	
}
ÄÄ 
public
ÇÇ 
class
ÇÇ "
CitaConsultaResponse
ÇÇ &
{
ÉÉ 
public
ÑÑ 
List
ÑÑ 
<
ÑÑ 
Cita
ÑÑ 
>
ÑÑ 
Citas
ÑÑ 
{
ÑÑ  !
get
ÑÑ" %
;
ÑÑ% &
set
ÑÑ' *
;
ÑÑ* +
}
ÑÑ, -
public
ÖÖ 
string
ÖÖ 
Mensaje
ÖÖ 
{
ÖÖ 
get
ÖÖ  #
;
ÖÖ# $
set
ÖÖ% (
;
ÖÖ( )
}
ÖÖ* +
public
ÜÜ 
bool
ÜÜ 
Error
ÜÜ 
{
ÜÜ 
get
ÜÜ 
;
ÜÜ  
set
ÜÜ! $
;
ÜÜ$ %
}
ÜÜ& '
public
áá "
CitaConsultaResponse
áá #
(
áá# $
List
áá$ (
<
áá( )
Cita
áá) -
>
áá- .
citas
áá/ 4
)
áá4 5
{
àà 	
Citas
ââ 
=
ââ 
citas
ââ 
;
ââ 
Error
ää 
=
ää 
false
ää 
;
ää 
}
ãã 	
public
åå "
CitaConsultaResponse
åå #
(
åå# $
string
åå$ *
mensaje
åå+ 2
)
åå2 3
{
çç 	
Mensaje
éé 
=
éé 
mensaje
éé 
;
éé 
Error
èè 
=
èè 
true
èè 
;
èè 
}
êê 	
}
ëë 
public
íí 

class
íí !
CitaGuardarResponse
íí $
{
ìì 
public
îî 
Cita
îî 
Cita
îî 
{
îî 
get
îî 
;
îî 
set
îî  #
;
îî# $
}
îî% &
public
ïï 
string
ïï 
Mensaje
ïï 
{
ïï 
get
ïï  #
;
ïï# $
set
ïï% (
;
ïï( )
}
ïï* +
public
ññ 
bool
ññ 
IsError
ññ 
{
ññ 
get
ññ !
;
ññ! "
set
ññ# &
;
ññ& '
}
ññ( )
public
òò !
CitaGuardarResponse
òò "
(
òò" #
Cita
òò# '
cita
òò( ,
)
òò, -
{
ôô 	
Cita
öö 
=
öö 
cita
öö 
;
öö 
IsError
úú 
=
úú 
false
úú 
;
úú 
}
ùù 	
public
ûû !
CitaGuardarResponse
ûû "
(
ûû" #
string
ûû# )
mensaje
ûû* 1
)
ûû1 2
{
üü 	
Mensaje
†† 
=
†† 
mensaje
†† 
;
†† 
IsError
°° 
=
°° 
true
°° 
;
°° 
}
¢¢ 	
}
££ 
}•• ùC
SD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\EnfermedadService.cs
	namespace		 	
Logica		
 
{

 
public 

class 
EnfermedadService "
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
EnfermedadService  
(  !
ConsultorioContext! 3
context4 ;
); <
{ 	
_context 
= 
context 
; 
} 	
public &
EnfermedadConsultaResponse )
	Consultar* 3
(3 4
)4 5
{ 	
try 
{ 
return 
new &
EnfermedadConsultaResponse 5
(5 6
_context6 >
.> ?
enfermedades? K
.K L
ToListL R
(R S
)S T
)T U
;U V
} 
catch 
( 
	Exception 
e 
) 
{ 
return 
new &
EnfermedadConsultaResponse 5
(5 6
$"6 8
$str8 W
{W X
eX Y
.Y Z
MessageZ a
}a b
"b c
)c d
;d e
} 
}!! 	
public## 
List## 
<## 
string## 
>## 
ListaCodigo3## (
(##( )
)##) *
{##* +
List$$ 
<$$ 

Enfermedad$$ 
>$$ 
enfermedads$$ (
=$$( )
_context$$) 1
.$$1 2
enfermedades$$2 >
.$$> ?
ToList$$? E
($$E F
)$$F G
;$$G H
List%% 
<%% 
string%% 
>%% 
codigo3%%  
=%%  !
new%%" %
List%%& *
<%%* +
string%%+ 1
>%%1 2
(%%2 3
)%%3 4
;%%4 5
var'' 
	almacenar'' 
='' 
_context'' '
.''' (
enfermedades''( 4
.''4 5
Select''5 ;
(''; <
e''< =
=>''= ?
new''? B
{''C D
e''D E
.''E F
Codigo_3''F N
}''N O
)''O P
.''P Q
Distinct''Q Y
(''Y Z
)''Z [
.''[ \
ToList''\ b
(''b c
)''c d
;''d e
foreach(( 
((( 
var(( 
item(( 
in(( 
	almacenar((  )
)(() *
{((* +
if)) 
()) 
item)) 
.)) 
Codigo_3))  
!=))  "
null))" &
)))' (
{))( )
var** 

almacenar1** "
=**" #
item**# '
.**' (
Codigo_3**( 0
;**0 1
codigo3++ 
.++ 
Add++ 
(++  

almacenar1++  *
)++* +
;+++ ,
},, 
}-- 
return.. 
codigo3.. 
;.. 
}// 	
public11 
List11 
<11 
string11 
>11 
ListaDescripcion311 -
(11- .
string11. 4
codigo3115 <
)11< =
{11= >
List22 
<22 

Enfermedad22 
>22 
enfermedads22 (
=22( )
_context22) 1
.221 2
enfermedades222 >
.22> ?
ToList22? E
(22E F
)22F G
;22G H
List33 
<33 
string33 
>33 
descripcion333 %
=33% &
new33' *
List33+ /
<33/ 0
string330 6
>336 7
(337 8
)338 9
;339 :
foreach44 
(44 
var44 
item44 
in44 
enfermedads44  +
)44+ ,
{44, -
if55 
(55 
item55 
.55 
Codigo_355  
==55  "
codigo355" )
&&55* ,
item55- 1
.551 2
Descripcion_3552 ?
!=55? A
null55A E
)55E F
{55F G
var66 
	almacenar66 !
=66! "
item66" &
.66& '
Descripcion_366' 4
;664 5
descripcion377  
.77  !
Add77! $
(77$ %
	almacenar77% .
)77. /
;77/ 0
}88 
}99 
return:: 
descripcion3:: 
;::  
};; 	
public<<	 
List<< 
<<< 
string<< 
><< 
ListaCodigo4<< )
(<<) *
string<<* 0
codigo3<<1 8
)<<8 9
{<<9 :
List== 
<== 

Enfermedad== 
>== 
enfermedads== (
===( )
_context==) 1
.==1 2
enfermedades==2 >
.==> ?
ToList==? E
(==E F
)==F G
;==G H
List>> 
<>> 
string>> 
>>> 
codigo4>>  
=>>  !
new>>" %
List>>& *
<>>* +
string>>+ 1
>>>1 2
(>>2 3
)>>3 4
;>>4 5
foreach?? 
(?? 
var?? 
item?? 
in?? 
enfermedads??  +
)??+ ,
{??, -
if@@ 
(@@ 
item@@ 
.@@ 
Codigo_3@@  
==@@  "
codigo3@@" )
)@@) *
{@@* +
varAA 
	almacenarAA !
=AA! "
itemAA" &
.AA& '
Codigo_4AA' /
;AA/ 0
codigo4BB 
.BB 
AddBB 
(BB 
	almacenarBB (
)BB( )
;BB) *
}CC 
}DD 
returnEE 
codigo4EE 
;EE 
}FF 	
publicGG 
ListGG 
<GG 
stringGG 
>GG 
ListaDescripcion4GG -
(GG- .
stringGG. 4
codigo4GG5 <
)GG< =
{GG= >
ListHH 
<HH 

EnfermedadHH 
>HH 
enfermedadsHH (
=HH( )
_contextHH) 1
.HH1 2
enfermedadesHH2 >
.HH> ?
ToListHH? E
(HHE F
)HHF G
;HHG H
ListII 
<II 
stringII 
>II 
descripcion4II %
=II% &
newII' *
ListII+ /
<II/ 0
stringII0 6
>II6 7
(II7 8
)II8 9
;II9 :
foreachJJ 
(JJ 
varJJ 
itemJJ 
inJJ 
enfermedadsJJ  +
)JJ+ ,
{JJ, -
ifKK 
(KK 
itemKK 
.KK 
Codigo_4KK  
==KK  "
codigo4KK" )
)KK* +
{KK+ ,
varLL 
	almacenarLL !
=LL! "
itemLL" &
.LL& '
Descripcion_4LL' 4
;LL4 5
descripcion4MM  
.MM  !
AddMM! $
(MM$ %
	almacenarMM% .
)MM. /
;MM/ 0
}NN 
}OO 
returnPP 
descripcion4PP 
;PP  
}QQ 	
}SS 
publicTT 

classTT &
EnfermedadConsultaResponseTT +
{UU 
publicVV 
ListVV 
<VV 

EnfermedadVV 
>VV 
EnfermedadesVV  ,
{VV- .
getVV/ 2
;VV2 3
setVV4 7
;VV7 8
}VV9 :
publicWW 
stringWW 
MensajeWW 
{WW 
getWW  #
;WW# $
setWW% (
;WW( )
}WW* +
publicXX 
boolXX 
ErrorXX 
{XX 
getXX 
;XX  
setXX! $
;XX$ %
}XX& '
publicYY &
EnfermedadConsultaResponseYY )
(YY) *
ListYY* .
<YY. /

EnfermedadYY/ 9
>YY9 :
enfermedadesYY; G
)YYG H
{ZZ 	
Enfermedades[[ 
=[[ 
enfermedades[[ '
;[[' (
Error\\ 
=\\ 
false\\ 
;\\ 
}]] 	
public^^ &
EnfermedadConsultaResponse^^ )
(^^) *
string^^* 0
mensaje^^1 8
)^^8 9
{__ 	
Mensaje`` 
=`` 
mensaje`` 
;`` 
Erroraa 
=aa 
trueaa 
;aa 
}bb 	
}cc 
}dd Æ 
LD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\EpsService.cs
	namespace		 	
Logica		
 
{

 
public 

class 

EpsService 
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 

EpsService 
( 
ConsultorioContext ,
context- 4
)4 5
{ 	
_context 
= 
context 
; 
} 	
public 
EpsConsultaResponse "
	Consultar# ,
(, -
)- .
{ 	
try 
{ 
return 
new 
EpsConsultaResponse .
(. /
_context/ 7
.7 8
eps8 ;
.; <
ToList< B
(B C
)C D
)D E
;E F
} 
catch 
( 
	Exception 
e 
) 
{ 
return 
new 
EpsConsultaResponse .
(. /
$"/ 1
$str1 P
{P Q
eQ R
.R S
MessageS Z
}Z [
"[ \
)\ ]
;] ^
}   
}## 	
public$$ 
List$$ 
<$$ 
string$$ 
>$$ 
consultaEps$$ '
($$' (
)$$( )
{$$) *
List%% 
<%% 
string%% 
>%% 
listaEps%% !
=%%" #
new%%$ '
List%%( ,
<%%, -
string%%- 3
>%%3 4
(%%4 5
)%%5 6
;%%6 7
List&& 
<&& 
Eps&& 
>&& 
epses&& 
=&& 
_context&& %
.&&% &
eps&&& )
.&&) *
ToList&&* 0
(&&0 1
)&&1 2
;&&2 3
var'' 
	almacenar'' 
='' 
_context'' #
.''# $
eps''$ '
.''' (
Select''( .
(''. /
e''/ 0
=>''0 2
new''2 5
{''6 7
e''7 8
.''8 9
Administradora''9 G
}''G H
)''H I
.''I J
Distinct''J R
(''R S
)''S T
.''T U
ToList''U [
(''[ \
)''\ ]
;''] ^
foreach(( 
((( 
var(( 
item(( 
in(( 
epses((  %
)((% &
{((& '
var)) 
	nombreEps)) 
=)) 
item)) "
.))" #
Administradora))# 1
;))1 2
listaEps** 
.** 
Add** 
(** 
	nombreEps** &
)**& '
;**' (
}++ 
return,, 
listaEps,, 
;,, 
}-- 	
public.. 
class.. 
EpsConsultaResponse.. (
{// 	
public00 
List00 
<00 
Eps00 
>00 
Eps00  
{00! "
get00# &
;00& '
set00( +
;00+ ,
}00- .
public11 
string11 
Mensaje11 !
{11" #
get11$ '
;11' (
set11) ,
;11, -
}11. /
public22 
bool22 
Error22 
{22 
get22  #
;22# $
set22% (
;22( )
}22* +
public33 
EpsConsultaResponse33 &
(33& '
List33' +
<33+ ,
Eps33, /
>33/ 0
eps331 4
)334 5
{44 
Eps55 
=55 
eps55 
;55 
Error66 
=66 
false66 
;66 
}77 
public88 
EpsConsultaResponse88 &
(88& '
string88' -
mensaje88. 5
)885 6
{99 
Mensaje:: 
=:: 
mensaje:: !
;::! "
Error;; 
=;; 
true;; 
;;; 
}<< 
}== 	
}>> 
}@@ øU
SD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\EvaluacionService.cs
	namespace 	
Logica
 
{ 
public		 

class		 
EvaluacionService		 "
{

 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
EvaluacionService  
(  !
ConsultorioContext! 3
context4 ;
); <
{ 	
_context 
= 
context 
; 
} 	
public %
EvaluacionGuardarResponse (
Guardar) 0
(0 1

Evaluacion1 ;

evaluacion< F
)F G
{ 	
try 
{ 
var 
Paciente 
= 
_context %
.% &
	pacientes& /
./ 0
Find0 4
(4 5

evaluacion5 ?
.? @
paciente@ H
.H I
identificacionI W
)W X
;X Y
var 
	Psicologo 
= 
_context &
.& '

psicologos' 1
.1 2
Find2 6
(6 7

evaluacion7 A
.A B
	PsicologoB K
.K L
identificacionL Z
)Z [
;[ \
if 
( 
Paciente 
== 
null #
&&$ &
	Psicologo' 0
==0 2
null2 6
)6 7
{ 
return 
new %
EvaluacionGuardarResponse 8
(8 9
$"9 ;
$str; n
"n o
)o p
;p q
} 

evaluacion 
. 
paciente #
=# $
Paciente$ ,
;, -

evaluacion 
. 
	Psicologo $
=$ %
	Psicologo% .
;. /
_context   
.   
evaluaciones   %
.  % &
Add  & )
(  ) *

evaluacion  * 4
)  4 5
;  5 6
_context!! 
.!! 
SaveChanges!! $
(!!$ %
)!!% &
;!!& '
return"" 
new"" %
EvaluacionGuardarResponse"" 4
(""4 5

evaluacion""5 ?
)""? @
;""@ A
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 
return&& 
new&& %
EvaluacionGuardarResponse&& 4
(&&4 5
$"&&5 7
$str&&7 T
{&&T U
e&&V W
.&&W X
Message&&X _
}&&_ `
"&&` a
)&&a b
;&&b c
}'' 
})) 	
public** 
string** 
Eliminar** 
(** 
string** %
idEvaluacion**& 2
)**2 3
{++ 	
try,, 
{-- 
var.. 

evaluacion.. 
=..  
_context..! )
...) *
evaluaciones..* 6
...6 7
Find..7 ;
(..; <
idEvaluacion..< H
)..H I
;..I J
if// 
(// 

evaluacion// 
!=// !
null//" &
)//& '
{00 
_context11 
.11 
Remove11 #
(11# $

evaluacion11$ .
)11. /
;11/ 0
_context22 
.22 
SaveChanges22 (
(22( )
)22) *
;22* +
return33 
$"33 
$str33 ?
{33? @
idEvaluacion33@ L
}33L M
"33M N
;33N O
}44 
return55 
$"55 
$str55 b
{55b c
idEvaluacion55c o
}55o p
"55p q
;55q r
}66 
catch77 
(77 
	Exception77 
e77 
)77 
{88 
return99 
$"99 
$str99 7
{997 8
e998 9
.999 :
Message99: A
}99A B
"99B C
;99C D
}:: 
}<< 	
public== &
EvaluacionConsultaResponse== )
	Consultar==* 3
(==3 4
)==4 5
{>> 	
try?? 
{@@ 
returnBB 
newBB &
EvaluacionConsultaResponseBB 5
(BB5 6
_contextBB6 >
.BB> ?
evaluacionesBB? K
.BBK L
ToListBBL R
(BBR S
)BBS T
)BBT U
;BBU V
}DD 
catchEE 
(EE 
	ExceptionEE 
eEE 
)EE 
{FF 
returnGG 
newGG &
EvaluacionConsultaResponseGG 5
(GG5 6
$"GG6 8
$strGG8 W
{GGW X
eGGX Y
.GGY Z
MessageGGZ a
}GGa b
"GGb c
)GGc d
;GGd e
}HH 
}JJ 	
publicKK $
EvaluacionBuscarResponseKK '
BuscarKK( .
(KK. /
stringKK/ 5
idEvaluacionKK6 B
)KKB C
{LL 	
tryMM 
{NN 
varPP 

evaluacionPP 
=PP  
_contextPP! )
.PP) *
evaluacionesPP* 6
.PP6 7
FindPP7 ;
(PP; <
idEvaluacionPP< H
)PPH I
;PPI J
ifQQ 
(QQ 

evaluacionQQ 
==QQ !
nullQQ" &
)QQ& '
{RR 
throwTT 
newTT +
EvaluacionNoEncontradaExceptionTT =
(TT= >
$strTT> }
)TT} ~
;TT~ 
}UU 
returnVV 
newVV $
EvaluacionBuscarResponseVV 3
(VV3 4

evaluacionVV4 >
)VV> ?
;VV? @
}WW 
catchXX 
(XX +
EvaluacionNoEncontradaExceptionXX 2
eXX3 4
)XX4 5
{YY 
returnZZ 
newZZ $
EvaluacionBuscarResponseZZ 3
(ZZ3 4
$strZZ4 F
+ZZG H
eZZI J
.ZZJ K
MessageZZK R
)ZZR S
;ZZS T
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 
new^^ $
EvaluacionBuscarResponse^^ 3
(^^3 4
$str^^4 Q
+^^R S
e^^T U
.^^U V
Message^^V ]
)^^] ^
;^^^ _
}__ 
}aa 	
}bb 
publiccc 
classcc $
EvaluacionBuscarResponsecc *
{dd 
publicee 

Evaluacionee 

Evaluacionee $
{ee% &
getee' *
;ee* +
setee, /
;ee/ 0
}ee1 2
publicff 
stringff 
Mensajeff 
{ff 
getff  #
;ff# $
setff% (
;ff( )
}ff* +
publicgg 
boolgg 
IsErrorgg 
{gg 
getgg !
;gg! "
setgg# &
;gg& '
}gg( )
publicii $
EvaluacionBuscarResponseii '
(ii' (

Evaluacionii( 2

evaluacionii3 =
)ii= >
{jj 	

Evaluacionkk 
=kk 

evaluacionkk #
;kk# $
IsErrorll 
=ll 
falsell 
;ll 
}mm 	
publicnn $
EvaluacionBuscarResponsenn '
(nn' (
stringnn( .
mensajenn/ 6
)nn6 7
{oo 	
Mensajepp 
=pp 
mensajepp 
;pp 
IsErrorqq 
=qq 
trueqq 
;qq 
}rr 	
}ss 
publictt 
classtt &
EvaluacionConsultaResponsett ,
{uu 
publicvv 
Listvv 
<vv 

Evaluacionvv 
>vv 
Evaluacionesvv  ,
{vv- .
getvv/ 2
;vv2 3
setvv4 7
;vv7 8
}vv9 :
publicww 
stringww 
Mensajeww 
{ww 
getww  #
;ww# $
setww% (
;ww( )
}ww* +
publicxx 
boolxx 
Errorxx 
{xx 
getxx 
;xx  
setxx! $
;xx$ %
}xx& '
publicyy &
EvaluacionConsultaResponseyy )
(yy) *
Listyy* .
<yy. /

Evaluacionyy/ 9
>yy9 :
evaluacionesyy; G
)yyG H
{zz 	
Evaluaciones{{ 
={{ 
evaluaciones{{ '
;{{' (
Error|| 
=|| 
false|| 
;|| 
}}} 	
public~~ &
EvaluacionConsultaResponse~~ )
(~~) *
string~~* 0
mensaje~~1 8
)~~8 9
{ 	
Mensaje
ÄÄ 
=
ÄÄ 
mensaje
ÄÄ 
;
ÄÄ 
Error
ÅÅ 
=
ÅÅ 
true
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
}
ÉÉ 
public
ÑÑ 
class
ÑÑ '
EvaluacionGuardarResponse
ÑÑ +
{
ÖÖ 
public
ÜÜ 

Evaluacion
ÜÜ 

Evaluacion
ÜÜ $
{
ÜÜ% &
get
ÜÜ' *
;
ÜÜ* +
set
ÜÜ, /
;
ÜÜ/ 0
}
ÜÜ1 2
public
áá 
string
áá 
Mensaje
áá 
{
áá 
get
áá  #
;
áá# $
set
áá% (
;
áá( )
}
áá* +
public
àà 
bool
àà 
IsError
àà 
{
àà 
get
àà !
;
àà! "
set
àà# &
;
àà& '
}
àà( )
public
ää '
EvaluacionGuardarResponse
ää (
(
ää( )

Evaluacion
ää) 3

evaluacion
ää4 >
)
ää> ?
{
ãã 	

Evaluacion
åå 
=
åå 

evaluacion
åå !
;
åå! "
IsError
éé 
=
éé 
false
éé 
;
éé 
}
èè 	
public
êê '
EvaluacionGuardarResponse
êê (
(
êê( )
string
êê) /
mensaje
êê0 7
)
êê7 8
{
ëë 	
Mensaje
íí 
=
íí 
mensaje
íí 
;
íí 
IsError
ìì 
=
ìì 
true
ìì 
;
ìì 
}
îî 	
}
ïï 
public
ññ 

class
ññ -
EvaluacionNoEncontradaException
ññ 0
:
ññ1 2
	Exception
ññ3 <
{
óó 
public
òò -
EvaluacionNoEncontradaException
òò .
(
òò. /
)
òò/ 0
{
ôô 	
}
öö 	
public
úú -
EvaluacionNoEncontradaException
úú .
(
úú. /
string
úú/ 5
message
úú6 =
)
úú= >
:
úú? @
base
úúA E
(
úúE F
message
úúF M
)
úúM N
{
ùù 	
}
üü 	
}
†† 
}¢¢ ˜H
QD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\PacienteService.cs
	namespace		 	
Logica		
 
{

 
public 

class 
PacienteService  
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
PacienteService 
( 
ConsultorioContext 1
context2 9
)9 :
{ 	
_context 
= 
context 
; 
} 	
public #
GuardarPacienteResponse &
Guardar' .
(. /
Paciente/ 7
paciente8 @
)@ A
{ 	
try 
{ 
var )
PacienteBuscadoIdentificacion 1
=2 3
_context4 <
.< =
	pacientes= F
.F G
FindG K
(K L
pacienteL T
.T U
identificacionU c
)c d
;d e
if 
( )
PacienteBuscadoIdentificacion4 Q
!=R T
nullU Y
)Y Z
{ 
return 
new #
GuardarPacienteResponse 6
(6 7
$str	7 â
)
â ä
;
ä ã
} 
_context 
. 
	pacientes "
." #
Add# &
(& '
paciente' /
)/ 0
;0 1
_context   
.   
SaveChanges   $
(  $ %
)  % &
;  & '
return!! 
new!! #
GuardarPacienteResponse!! 2
(!!2 3
paciente!!3 ;
)!!; <
;!!< =
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 
return%% 
new%% #
GuardarPacienteResponse%% 2
(%%2 3
$"%%3 5
$str%%5 M
{%%M N
e%%N O
.%%O P
Message%%P W
}%%W X
"%%X Y
)%%Y Z
;%%Z [
}&& 
}'' 	
public)) 
string)) 
Eliminar)) 
()) 
string)) %
nombreusuario))& 3
)))3 4
{** 	
try++ 
{,, 
var-- 
paciente-- 
=-- 
_context-- '
.--' (
	pacientes--( 1
.--1 2
Find--2 6
(--6 7
nombreusuario--7 D
)--D E
;--E F
if.. 
(.. 
paciente.. 
!=.. 
null..  $
)..$ %
{// 
_context00 
.00 
Remove00 #
(00# $
paciente00$ ,
)00, -
;00- .
_context11 
.11 
SaveChanges11 (
(11( )
)11) *
;11* +
return22 
$"22 
$str22 N
{22N O
nombreusuario22O \
}22\ ]
"22] ^
;22^ _
}33 
return44 
$"44 
$str44 u
{44u v
nombreusuario	44v É
}
44É Ñ
"
44Ñ Ö
;
44Ö Ü
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
return88 
$"88 
$str88 7
{887 8
e888 9
.889 :
Message88: A
}88A B
"88B C
;88C D
}99 
};; 	
public== $
PacienteConsultaResponse== '&
ConsultarTodosLosPacientes==( B
(==B C
)==C D
{>> 	
try?? 
{@@ 
returnBB 
newBB $
PacienteConsultaResponseBB 3
(BB3 4
_contextBB4 <
.BB< =
	pacientesBB= F
.BBF G
ToListBBG M
(BBM N
)BBN O
)BBO P
;BBP Q
}DD 
catchEE 
(EE 
	ExceptionEE 
eEE 
)EE 
{FF 
returnGG 
newGG $
PacienteConsultaResponseGG 3
(GG3 4
$"GG4 6
$strGG6 U
{GGU V
eGGV W
.GGW X
MessageGGX _
}GG_ `
"GG` a
)GGa b
;GGb c
}HH 
}JJ 	
publicLL "
PacienteBuscarResponseLL %
BuscarLL& ,
(LL, -
stringLL- 3
identificacionLL4 B
)LLB C
{MM 	
tryNN 
{OO 
varQQ 
pacienteQQ 
=QQ 
_contextQQ '
.QQ' (
	pacientesQQ( 1
.QQ1 2
FindQQ2 6
(QQ6 7
identificacionQQ7 E
)QQE F
;QQF G
ifRR 
(RR 
pacienteRR 
==RR 
nullRR  $
)RR$ %
{SS 
returnUU 
newUU "
PacienteBuscarResponseUU 5
(UU5 6
$strUU6 u
)UUu v
;UUv w
}VV 
returnWW 
newWW "
PacienteBuscarResponseWW 1
(WW1 2
pacienteWW2 :
)WW: ;
;WW; <
}XX 
catchYY 
(YY 
	ExceptionYY 
eYY 
)YY 
{ZZ 
return[[ 
new[[ "
PacienteBuscarResponse[[ 1
([[1 2
$str[[2 D
+[[E F
e[[G H
.[[H I
Message[[I P
)[[P Q
;[[Q R
}\\ 
}]] 	
}__ 
publiccc 

classcc #
GuardarPacienteResponsecc (
{dd 
publicee #
GuardarPacienteResponseee &
(ee& '
Pacienteee' /
pacienteee0 8
)ee8 9
{ff 	
Errorgg 
=gg 
falsegg 
;gg 
thishh 
.hh 
Pacientehh 
=hh 
pacientehh $
;hh$ %
}ii 	
publicjj #
GuardarPacienteResponsejj &
(jj& '
stringjj' -
mensajejj. 5
)jj5 6
{kk 	
Errorll 
=ll 
truell 
;ll 
Mensajemm 
=mm 
mensajemm 
;mm 
}nn 	
publicoo 
booloo 
Erroroo 
{oo 
getoo 
;oo  
setoo! $
;oo$ %
}oo& '
publicpp 
stringpp 
Mensajepp 
{pp 
getpp  #
;pp# $
setpp% (
;pp( )
}pp* +
publicqq 
Pacienteqq 
Pacienteqq  
{qq! "
getqq# &
;qq& '
setqq( +
;qq+ ,
}qq- .
}ss 
publicuu 

classuu $
PacienteConsultaResponseuu )
{vv 
publicww 
Listww 
<ww 
Pacienteww 
>ww 
	Pacientesww '
{ww( )
getww* -
;ww- .
setww/ 2
;ww2 3
}ww4 5
publicxx 
stringxx 
Mensajexx 
{xx 
getxx  #
;xx# $
setxx% (
;xx( )
}xx* +
publicyy 
boolyy 
Erroryy 
{yy 
getyy 
;yy  
setyy! $
;yy$ %
}yy& '
publiczz $
PacienteConsultaResponsezz '
(zz' (
Listzz( ,
<zz, -
Pacientezz- 5
>zz5 6
	pacienteszz7 @
)zz@ A
{{{ 	
	Pacientes|| 
=|| 
	pacientes|| !
;||! "
Error}} 
=}} 
false}} 
;}} 
}~~ 	
public $
PacienteConsultaResponse '
(' (
string( .
mensaje/ 6
)6 7
{
ÄÄ 	
Mensaje
ÅÅ 
=
ÅÅ 
mensaje
ÅÅ 
;
ÅÅ 
Error
ÇÇ 
=
ÇÇ 
true
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
public
ÜÜ 

class
ÜÜ $
PacienteBuscarResponse
ÜÜ '
{
áá 
public
àà 
Paciente
àà 
Paciente
àà  
{
àà! "
get
àà# &
;
àà& '
set
àà( +
;
àà+ ,
}
àà- .
public
ââ 
string
ââ 
Mensaje
ââ 
{
ââ 
get
ââ  #
;
ââ# $
set
ââ% (
;
ââ( )
}
ââ* +
public
ää 
bool
ää 
IsError
ää 
{
ää 
get
ää !
;
ää! "
set
ää# &
;
ää& '
}
ää( )
public
åå $
PacienteBuscarResponse
åå %
(
åå% &
Paciente
åå& .
paciente
åå/ 7
)
åå7 8
{
çç 	
Paciente
éé 
=
éé 
paciente
éé 
;
éé  
IsError
èè 
=
èè 
false
èè 
;
èè 
}
êê 	
public
ëë $
PacienteBuscarResponse
ëë %
(
ëë% &
string
ëë& ,
mensaje
ëë- 4
)
ëë4 5
{
íí 	
Mensaje
ìì 
=
ìì 
mensaje
ìì 
;
ìì 
IsError
îî 
=
îî 
true
îî 
;
îî 
}
ïï 	
}
ññ 
}òò òl
RD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\PsicologoService.cs
	namespace

 	
Logica


 
{ 
public 

class 
PsicologoService !
{ 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
PsicologoService 
(  
ConsultorioContext  2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public $
GuardarPsicologoResponse '
Guardar( /
(/ 0
	Psicologo0 9
	psicologo: C
)C D
{ 	
try 
{ 
var *
PsicologoBuscadoIdentificacion 2
=3 4
_context5 =
.= >

psicologos> H
.H I
FindI M
(M N
	psicologoN W
.W X
identificacionX f
)f g
;g h
if 
( *
PsicologoBuscadoIdentificacion 2
!=3 5
null6 :
): ;
{ 
return 
new $
GuardarPsicologoResponse 7
(7 8
$str	8 ù
)
ù û
;
û ü
}   
_context"" 
."" 

psicologos"" #
.""# $
Add""$ '
(""' (
	psicologo""( 1
)""1 2
;""2 3
_context## 
.## 
SaveChanges## $
(##$ %
)##% &
;##& '
return$$ 
new$$ $
GuardarPsicologoResponse$$ 3
($$3 4
	psicologo$$4 =
)$$= >
;$$> ?
}%% 
catch&& 
(&& 
	Exception&& 
e&& 
)&& 
{'' 
return(( 
new(( $
GuardarPsicologoResponse(( 3
(((3 4
$"((4 6
$str((6 N
{((N O
e((O P
.((P Q
Message((Q X
}((X Y
"((Y Z
)((Z [
;(([ \
})) 
}** 	
public,, 
string,, 
Eliminar,, 
(,, 
string,, %
identificacion,,& 4
),,4 5
{-- 	
try.. 
{// 
var00 
	Psicologo00 
=00 
_context00  (
.00( )

psicologos00) 3
.003 4
Find004 8
(008 9
identificacion009 G
)00G H
;00H I
if11 
(11 
	Psicologo11 
!=11  
null11! %
)11% &
{22 
_context33 
.33 
Remove33 #
(33# $
	Psicologo33$ -
)33- .
;33. /
_context44 
.44 
SaveChanges44 (
(44( )
)44) *
;44* +
return55 
$"55 
$str55 U
{55U V
identificacion55V d
}55d e
"55e f
;55f g
}66 
return77 
$"77 
$str77 q
{77q r
identificacion	77r Ä
}
77Ä Å
"
77Å Ç
;
77Ç É
}88 
catch99 
(99 
	Exception99 
e99 
)99 
{:: 
return;; 
$";; 
$str;; 7
{;;7 8
e;;8 9
.;;9 :
Message;;: A
};;A B
";;B C
;;;C D
}<< 
}>> 	
public?? %
PsicologoConsultaResponse?? (
	Consultar??) 2
(??2 3
)??3 4
{@@ 	
tryAA 
{BB 
returnDD 
newDD %
PsicologoConsultaResponseDD 4
(DD4 5
_contextDD5 =
.DD= >

psicologosDD> H
.DDH I
ToListDDI O
(DDO P
)DDP Q
)DDQ R
;DDR S
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 
returnII 
newII %
PsicologoConsultaResponseII 4
(II4 5
$"II5 7
$strII7 V
{IIV W
eIIW X
.IIX Y
MessageIIY `
}II` a
"IIa b
)IIb c
;IIc d
}JJ 
}LL 	
publicMM #
PsicologoBuscarResponseMM &
BuscarMM' -
(MM- .
stringMM. 4
identificacionMM5 C
)MMC D
{NN 	
tryOO 
{PP 
varRR 
	PsicologoRR 
=RR 
_contextRR  (
.RR( )

psicologosRR) 3
.RR3 4
FindRR4 8
(RR8 9
identificacionRR9 G
)RRG H
;RRH I
ifSS 
(SS 
	PsicologoSS 
==SS  
nullSS! %
)SS% &
{TT 
throwVV 
newVV *
PsicologoNoEncontradaExceptionVV <
(VV< =
$strVV= |
)VV| }
;VV} ~
}WW 
returnXX 
newXX #
PsicologoBuscarResponseXX 2
(XX2 3
	PsicologoXX3 <
)XX< =
;XX= >
}YY 
catchZZ 
(ZZ *
PsicologoNoEncontradaExceptionZZ 1
eZZ2 3
)ZZ3 4
{[[ 
return\\ 
new\\ #
PsicologoBuscarResponse\\ 2
(\\2 3
$str\\3 E
+\\F G
e\\H I
.\\I J
Message\\J Q
)\\Q R
;\\R S
}]] 
catch^^ 
(^^ 
	Exception^^ 
e^^ 
)^^ 
{__ 
return`` 
new`` #
PsicologoBuscarResponse`` 2
(``2 3
$str``3 P
+``Q R
e``S T
.``T U
Message``U \
)``\ ]
;``] ^
}aa 
}cc 	
publicdd 
CitaBuscarResponsedd !
BuscarTerapiadd" /
(dd/ 0
stringdd0 6
tipoCitadd7 ?
)dd? @
{ee 	
tryff 
{gg 
varii 
citaii 
=ii 
_contextii #
.ii# $
citasii$ )
.ii) *
Findii* .
(ii. /
tipoCitaii/ 7
)ii7 8
;ii8 9
ifjj 
(jj 
citajj 
==jj 
nulljj  
)jj  !
{kk 
throwmm 
newmm %
CitaNoEncontradaExceptionmm 7
(mm7 8
$strmm8 w
)mmw x
;mmx y
}nn 
returnoo 
newoo 
CitaBuscarResponseoo -
(oo- .
citaoo. 2
)oo2 3
;oo3 4
}pp 
catchqq 
(qq %
CitaNoEncontradaExceptionqq ,
eqq- .
)qq. /
{rr 
returnss 
newss 
CitaBuscarResponsess -
(ss- .
$strss. @
+ssA B
essC D
.ssD E
MessagessE L
)ssL M
;ssM N
}tt 
catchuu 
(uu 
	Exceptionuu 
euu 
)uu 
{vv 
returnww 
newww 
CitaBuscarResponseww -
(ww- .
$strww. K
+wwL M
ewwN O
.wwO P
MessagewwP W
)wwW X
;wwX Y
}xx 
}zz 	
}|| 
public 

class $
GuardarPsicologoResponse )
{
ÄÄ 
public
ÅÅ &
GuardarPsicologoResponse
ÅÅ '
(
ÅÅ' (
	Psicologo
ÅÅ( 1
	psicologo
ÅÅ2 ;
)
ÅÅ; <
{
ÇÇ 	
Error
ÉÉ 
=
ÉÉ 
false
ÉÉ 
;
ÉÉ 
this
ÑÑ 
.
ÑÑ 
	psicologo
ÑÑ 
=
ÑÑ 
	psicologo
ÑÑ &
;
ÑÑ& '
}
ÖÖ 	
public
ÜÜ &
GuardarPsicologoResponse
ÜÜ '
(
ÜÜ' (
string
ÜÜ( .
mensaje
ÜÜ/ 6
)
ÜÜ6 7
{
áá 	
Error
àà 
=
àà 
true
àà 
;
àà 
Mensaje
ââ 
=
ââ 
mensaje
ââ 
;
ââ 
}
ää 	
public
ãã 
bool
ãã 
Error
ãã 
{
ãã 
get
ãã 
;
ãã  
set
ãã! $
;
ãã$ %
}
ãã& '
public
åå 
string
åå 
Mensaje
åå 
{
åå 
get
åå  #
;
åå# $
set
åå% (
;
åå( )
}
åå* +
public
çç 
	Psicologo
çç 
	psicologo
çç "
{
çç# $
get
çç% (
;
çç( )
set
çç* -
;
çç- .
}
çç/ 0
}
èè 
public
êê 

class
êê %
PsicologoBuscarResponse
êê (
{
ëë 
public
íí 
	Psicologo
íí 
	Psicologo
íí "
{
íí# $
get
íí% (
;
íí( )
set
íí* -
;
íí- .
}
íí/ 0
public
ìì 
string
ìì 
Mensaje
ìì 
{
ìì 
get
ìì  #
;
ìì# $
set
ìì% (
;
ìì( )
}
ìì* +
public
îî 
bool
îî 
IsError
îî 
{
îî 
get
îî !
;
îî! "
set
îî# &
;
îî& '
}
îî( )
public
ññ %
PsicologoBuscarResponse
ññ &
(
ññ& '
	Psicologo
ññ' 0
	psicologo
ññ1 :
)
ññ: ;
{
óó 	
	Psicologo
òò 
=
òò 
	psicologo
òò !
;
òò! "
IsError
ôô 
=
ôô 
false
ôô 
;
ôô 
}
öö 	
public
õõ %
PsicologoBuscarResponse
õõ &
(
õõ& '
string
õõ' -
mensaje
õõ. 5
)
õõ5 6
{
úú 	
Mensaje
ùù 
=
ùù 
mensaje
ùù 
;
ùù 
IsError
ûû 
=
ûû 
true
ûû 
;
ûû 
}
üü 	
}
†† 
public
°° 
class
°° '
PsicologoConsultaResponse
°° +
{
¢¢ 
public
££ 
List
££ 
<
££ 
	Psicologo
££ 
>
££ 
	Psicologo
££ (
{
££) *
get
££+ .
;
££. /
set
££0 3
;
££3 4
}
££5 6
public
§§ 
string
§§ 
Mensaje
§§ 
{
§§ 
get
§§  #
;
§§# $
set
§§% (
;
§§( )
}
§§* +
public
•• 
bool
•• 
Error
•• 
{
•• 
get
•• 
;
••  
set
••! $
;
••$ %
}
••& '
public
¶¶ '
PsicologoConsultaResponse
¶¶ (
(
¶¶( )
List
¶¶) -
<
¶¶- .
	Psicologo
¶¶. 7
>
¶¶7 8
	psicologo
¶¶9 B
)
¶¶B C
{
ßß 	
	Psicologo
®® 
=
®® 
	psicologo
®® !
;
®®! "
Error
©© 
=
©© 
false
©© 
;
©© 
}
™™ 	
public
´´ '
PsicologoConsultaResponse
´´ (
(
´´( )
string
´´) /
mensaje
´´0 7
)
´´7 8
{
¨¨ 	
Mensaje
≠≠ 
=
≠≠ 
mensaje
≠≠ 
;
≠≠ 
Error
ÆÆ 
=
ÆÆ 
true
ÆÆ 
;
ÆÆ 
}
ØØ 	
}
∞∞ 
public
±± 
class
±± ,
PsicologoNoEncontradaException
±± 0
:
±±1 2
	Exception
±±3 <
{
≤≤ 
public
≥≥ ,
PsicologoNoEncontradaException
≥≥ -
(
≥≥- .
)
≥≥. /
{
¥¥ 	
}
µµ 	
public
∑∑ ,
PsicologoNoEncontradaException
∑∑ -
(
∑∑- .
string
∑∑. 4
message
∑∑5 <
)
∑∑< =
:
∑∑> ?
base
∑∑@ D
(
∑∑D E
message
∑∑E L
)
∑∑L M
{
∏∏ 	
}
∫∫ 	
}
ªª 
public
ºº 

class
ºº  
CitaBuscarResponse
ºº #
{
ΩΩ 
public
ææ 
Cita
ææ 
Cita
ææ 
{
ææ 
get
ææ 
;
ææ 
set
ææ  #
;
ææ# $
}
ææ% &
public
øø 
string
øø 
Mensaje
øø 
{
øø 
get
øø  #
;
øø# $
set
øø% (
;
øø( )
}
øø* +
public
¿¿ 
bool
¿¿ 
IsError
¿¿ 
{
¿¿ 
get
¿¿ !
;
¿¿! "
set
¿¿# &
;
¿¿& '
}
¿¿( )
public
¬¬  
CitaBuscarResponse
¬¬ !
(
¬¬! "
Cita
¬¬" &
cita
¬¬' +
)
¬¬+ ,
{
√√ 	
Cita
ƒƒ 
=
ƒƒ 
cita
ƒƒ 
;
ƒƒ 
IsError
≈≈ 
=
≈≈ 
false
≈≈ 
;
≈≈ 
}
∆∆ 	
public
««  
CitaBuscarResponse
«« !
(
««! "
string
««" (
mensaje
««) 0
)
««0 1
{
»» 	
Mensaje
…… 
=
…… 
mensaje
…… 
;
…… 
IsError
   
=
   
true
   
;
   
}
ÀÀ 	
}
ÃÃ 
public
ÕÕ 
class
ÕÕ '
CitaNoEncontradaException
ÕÕ +
:
ÕÕ, -
	Exception
ÕÕ. 7
{
ŒŒ 
public
œœ '
CitaNoEncontradaException
œœ (
(
œœ( )
)
œœ) *
{
–– 	
}
—— 	
public
”” '
CitaNoEncontradaException
”” (
(
””( )
string
””) /
message
””0 7
)
””7 8
:
””9 :
base
””; ?
(
””? @
message
””@ G
)
””G H
{
‘‘ 	
}
÷÷ 	
}
◊◊ 
}ÿÿ ÄV
TD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\TratamientoService.cs
	namespace 	
Logica
 
{ 
public		 

class		 
TratamientoService		 #
{

 
private 
readonly 
ConsultorioContext +
_context, 4
;4 5
public 
TratamientoService !
(! "
ConsultorioContext" 4
context5 <
)< =
{ 	
_context 
= 
context 
; 
} 	
public &
TratamientoGuardarResponse )
Guardar* 1
(1 2
Tratamiento2 =
tratamiento> I
)I J
{ 	
try 
{ 
var 
Paciente 
= 
_context %
.% &
	pacientes& /
./ 0
Find0 4
(4 5
tratamiento5 @
.@ A
pacienteA I
.I J
identificacionJ X
)X Y
;Y Z
var 
	Psicologo 
= 
_context &
.& '

psicologos' 1
.1 2
Find2 6
(6 7
tratamiento7 B
.B C
	PsicologoC L
.L M
identificacionM [
)[ \
;\ ]
if 
( 
Paciente 
== 
null #
&&$ &
	Psicologo' 0
==0 2
null2 6
)6 7
{ 
return 
new &
TratamientoGuardarResponse 9
(9 :
$": <
$str< o
"o p
)p q
;q r
} 
tratamiento 
. 
paciente $
=$ %
Paciente% -
;- .
tratamiento 
. 
	Psicologo %
=% &
	Psicologo& /
;/ 0
_context 
. 
tratamientos %
.% &
Add& )
() *
tratamiento* 5
)5 6
;6 7
_context   
.   
SaveChanges   $
(  $ %
)  % &
;  & '
return!! 
new!! &
TratamientoGuardarResponse!! 5
(!!5 6
tratamiento!!6 A
)!!A B
;!!B C
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 
return%% 
new%% &
TratamientoGuardarResponse%% 5
(%%5 6
$"%%6 8
$str%%8 U
{%%U V
e%%W X
.%%X Y
Message%%Y `
}%%` a
"%%a b
)%%b c
;%%c d
}&& 
}(( 	
public)) 
string)) 
Eliminar)) 
()) 
string)) %
idTratamiento))& 3
)))3 4
{** 	
try++ 
{,, 
var-- 
Tratamiento-- 
=--  !
_context--" *
.--* +
tratamientos--+ 7
.--7 8
Find--8 <
(--< =
idTratamiento--= J
)--J K
;--K L
if.. 
(.. 
Tratamiento.. 
!=..  "
null..# '
)..' (
{// 
_context00 
.00 
Remove00 #
(00# $
Tratamiento00$ /
)00/ 0
;000 1
_context11 
.11 
SaveChanges11 (
(11( )
)11) *
;11* +
return22 
$"22 
$str22 ?
{22? @
idTratamiento22@ M
}22M N
"22N O
;22O P
}33 
return44 
$"44 
$str44 b
{44b c
idTratamiento44c p
}44p q
"44q r
;44r s
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
return88 
$"88 
$str88 7
{887 8
e888 9
.889 :
Message88: A
}88A B
"88B C
;88C D
}99 
};; 	
public<< '
TratamientoConsultaResponse<< *
	Consultar<<+ 4
(<<4 5
)<<5 6
{== 	
try>> 
{?? 
returnAA 
newAA '
TratamientoConsultaResponseAA 6
(AA6 7
_contextAA7 ?
.AA? @
tratamientosAA@ L
.AAL M
ToListAAM S
(AAS T
)AAT U
)AAU V
;AAV W
}CC 
catchDD 
(DD 
	ExceptionDD 
eDD 
)DD 
{EE 
returnFF 
newFF '
TratamientoConsultaResponseFF 6
(FF6 7
$"FF7 9
$strFF9 X
{FFX Y
eFFY Z
.FFZ [
MessageFF[ b
}FFb c
"FFc d
)FFd e
;FFe f
}GG 
}II 	
publicJJ %
TratamientoBuscarResponseJJ (
BuscarJJ) /
(JJ/ 0
stringJJ0 6
idTratamientoJJ7 D
)JJD E
{KK 	
tryLL 
{MM 
varOO 
TratamientoOO 
=OO  !
_contextOO" *
.OO* +
tratamientosOO+ 7
.OO7 8
FindOO8 <
(OO< =
idTratamientoOO= J
)OOJ K
;OOK L
ifPP 
(PP 
TratamientoPP 
==PP  "
nullPP# '
)PP' (
{QQ 
throwSS 
newSS ,
 TratamientoNoEncontradaExceptionSS >
(SS> ?
$strSS? ~
)SS~ 
;	SS Ä
}TT 
returnUU 
newUU %
TratamientoBuscarResponseUU 4
(UU4 5
TratamientoUU5 @
)UU@ A
;UUA B
}VV 
catchWW 
(WW ,
 TratamientoNoEncontradaExceptionWW 3
eWW4 5
)WW5 6
{XX 
returnYY 
newYY %
TratamientoBuscarResponseYY 4
(YY4 5
$strYY5 G
+YYH I
eYYJ K
.YYK L
MessageYYL S
)YYS T
;YYT U
}ZZ 
catch[[ 
([[ 
	Exception[[ 
e[[ 
)[[ 
{\\ 
return]] 
new]] %
TratamientoBuscarResponse]] 4
(]]4 5
$str]]5 R
+]]S T
e]]U V
.]]V W
Message]]W ^
)]]^ _
;]]_ `
}^^ 
}`` 	
}cc 
publicdd 
classdd %
TratamientoBuscarResponsedd +
{ee 
publicff 
Tratamientoff 
Tratamientoff &
{ff' (
getff) ,
;ff, -
setff. 1
;ff1 2
}ff3 4
publicgg 
stringgg 
Mensajegg 
{gg 
getgg  #
;gg# $
setgg% (
;gg( )
}gg* +
publichh 
boolhh 
IsErrorhh 
{hh 
gethh !
;hh! "
sethh# &
;hh& '
}hh( )
publicjj %
TratamientoBuscarResponsejj (
(jj( )
Tratamientojj) 4
tratamientojj5 @
)jj@ A
{kk 	
Tratamientoll 
=ll 
tratamientoll %
;ll% &
IsErrormm 
=mm 
falsemm 
;mm 
}nn 	
publicoo %
TratamientoBuscarResponseoo (
(oo( )
stringoo) /
mensajeoo0 7
)oo7 8
{pp 	
Mensajeqq 
=qq 
mensajeqq 
;qq 
IsErrorrr 
=rr 
truerr 
;rr 
}ss 	
}tt 
publicuu 

classuu '
TratamientoConsultaResponseuu ,
{vv 
publicww 
Listww 
<ww 
Tratamientoww 
>ww  
Tratamientosww! -
{ww. /
getww0 3
;ww3 4
setww5 8
;ww8 9
}ww: ;
publicxx 
stringxx 
Mensajexx 
{xx 
getxx  #
;xx# $
setxx% (
;xx( )
}xx* +
publicyy 
boolyy 
Erroryy 
{yy 
getyy 
;yy  
setyy! $
;yy$ %
}yy& '
publiczz '
TratamientoConsultaResponsezz *
(zz* +
Listzz+ /
<zz/ 0
Tratamientozz0 ;
>zz; <
tratamientoszz= I
)zzI J
{{{ 	
Tratamientos|| 
=|| 
tratamientos|| '
;||' (
Error}} 
=}} 
false}} 
;}} 
}~~ 	
public '
TratamientoConsultaResponse *
(* +
string+ 1
mensaje2 9
)9 :
{
ÄÄ 	
Mensaje
ÅÅ 
=
ÅÅ 
mensaje
ÅÅ 
;
ÅÅ 
Error
ÇÇ 
=
ÇÇ 
true
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
public
ÖÖ 

class
ÖÖ (
TratamientoGuardarResponse
ÖÖ +
{
ÜÜ 
public
áá 
Tratamiento
áá 
Tratamiento
áá &
{
áá' (
get
áá) ,
;
áá, -
set
áá. 1
;
áá1 2
}
áá3 4
public
àà 
string
àà 
Mensaje
àà 
{
àà 
get
àà  #
;
àà# $
set
àà% (
;
àà( )
}
àà* +
public
ââ 
bool
ââ 
IsError
ââ 
{
ââ 
get
ââ !
;
ââ! "
set
ââ# &
;
ââ& '
}
ââ( )
public
ãã (
TratamientoGuardarResponse
ãã )
(
ãã) *
Tratamiento
ãã* 5
tratamiento
ãã6 A
)
ããA B
{
åå 	
Tratamiento
çç 
=
çç 
tratamiento
çç #
;
çç# $
IsError
èè 
=
èè 
false
èè 
;
èè 
}
êê 	
public
ëë (
TratamientoGuardarResponse
ëë )
(
ëë) *
string
ëë* 0
mensaje
ëë1 8
)
ëë8 9
{
íí 	
Mensaje
ìì 
=
ìì 
mensaje
ìì 
;
ìì 
IsError
îî 
=
îî 
true
îî 
;
îî 
}
ïï 	
}
ññ 
public
óó 

class
óó .
 TratamientoNoEncontradaException
óó 1
:
óó2 3
	Exception
óó4 =
{
òò 
public
ôô .
 TratamientoNoEncontradaException
ôô /
(
ôô/ 0
)
ôô0 1
{
öö 	
}
õõ 	
public
ùù .
 TratamientoNoEncontradaException
ùù /
(
ùù/ 0
string
ùù0 6
message
ùù7 >
)
ùù> ?
:
ùù@ A
base
ùùB F
(
ùùF G
message
ùùG N
)
ùùN O
{
ûû 	
}
†† 	
}
°° 
}¢¢ ˛
PD:\Upc\ProyectoModificaciones\Proyecto-Programacion-Web\Logica\UsuarioService.cs
	namespace 	
Logica
 
{ 
public 

class 
UsuarioService 
{		 
private

 
readonly

 
ConsultorioContext

 +
_context

, 4
;

4 5
public 
UsuarioService 
( 
ConsultorioContext 0
context1 8
)8 9
=>9 ;
_context< D
=E F
contextG N
;N O
public 
Usuario 
Validate 
(  
string  &
userName' /
,/ 0
string1 7
password8 @
)@ A
{ 	
return 
_context 
. 
usuarios $
.$ %
Where% *
(* +
t+ ,
=>- /
t0 1
.1 2
nombreUsuario2 ?
==@ B
userNameC K
&&L N
tO P
.P Q

contrasenaQ [
==\ ^
password_ g
&&h j
tk l
.l m
estadom s
==t v
$strw {
){ |
.| }
FirstOrDefault	} ã
(
ã å
)
å ç
;
ç é
} 	
public	 "
GuardarUsuarioResponse &
Guardar' .
(. /
Usuario/ 6
usuario7 >
)> ?
{ 	
try 
{ 
var 
BuscadoUser 
=  !
_context" *
.* +
	pacientes+ 4
.4 5
Find5 9
(9 :
usuario: A
.A B
nombreUsuarioB O
)O P
;P Q
if 
( 
BuscadoUser4 ?
!=@ B
nullC G
)G H
{ 
return 
new "
GuardarUsuarioResponse 5
(5 6
$str	6 à
)
à â
;
â ä
} 
_context 
. 
usuarios !
.! "
Add" %
(% &
usuario& -
)- .
;. /
_context 
. 
SaveChanges $
($ %
)% &
;& '
return 
new "
GuardarUsuarioResponse 1
(1 2
usuario2 9
)9 :
;: ;
} 
catch   
(   
	Exception   
e   
)   
{!! 
return"" 
new"" "
GuardarUsuarioResponse"" 1
(""1 2
$"""2 4
$str""4 L
{""L M
e""M N
.""N O
Message""O V
}""V W
"""W X
)""X Y
;""Y Z
}## 
}$$ 	
}&& 
public'' 
class'' "
GuardarUsuarioResponse'' (
{(( 
public)) 
Usuario)) 
usuario)) 
{))  
get))! $
;))$ %
set))& )
;))) *
}))+ ,
public** "
GuardarUsuarioResponse** %
(**% &
Usuario**& -
usuario**. 5
)**5 6
{++ 	
Error,, 
=,, 
false,, 
;,, 
this-- 
.-- 
usuario-- 
=-- 
usuario-- "
;--" #
}.. 	
public// "
GuardarUsuarioResponse// %
(//% &
string//& ,
mensaje//- 4
)//4 5
{00 	
Error11 
=11 
true11 
;11 
Mensaje22 
=22 
mensaje22 
;22 
}33 	
public44 
bool44 
Error44 
{44 
get44 
;44  
set44! $
;44$ %
}44& '
public55 
string55 
Mensaje55 
{55 
get55  #
;55# $
set55% (
;55( )
}55* +
}88 
}99 